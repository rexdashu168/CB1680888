<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CBå¯è½‰å‚µç™¼è¡Œæ­·å²åƒ¹æ ¼æŸ¥è©¢ - Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 50%, #4a5568 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 16px;
            padding: 35px 40px;
            margin-bottom: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.12);
            border-top: 5px solid #2563eb;
        }

        .header-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 12px;
        }

        .header-icon {
            font-size: 2em;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.1));
        }

        .header h1 {
            font-size: 2em;
            color: #1e40af;
            font-weight: 700;
            text-align: center;
        }

        .header .subtitle {
            text-align: center;
            font-size: 0.95em;
            color: #64748b;
            margin-top: 10px;
            line-height: 1.6;
        }

        .header .author {
            text-align: center;
            font-size: 0.9em;
            color: #94a3b8;
            margin-top: 8px;
            padding-top: 12px;
            border-top: 1px solid #e2e8f0;
        }

        .view-counter {
            text-align: center;
            color: #94a3b8;
            font-size: 12px;
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid #f1f5f9;
        }

        .view-counter strong {
            color: #2563eb;
            font-weight: 700;
        }

        .tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-button {
            padding: 14px 32px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #475569;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .tab-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
            border-color: #3b82f6;
            color: #1e40af;
        }

        .tab-button.active {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
            box-shadow: 0 4px 16px rgba(37, 99, 235, 0.3);
        }

        .tab-content {
            display: none;
            background: white;
            border-radius: 16px;
            padding: 35px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.12);
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .info-box {
            background: #eff6ff;
            padding: 20px 24px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #3b82f6;
        }

        .info-box h3 {
            color: #1e40af;
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-box p {
            color: #334155;
            line-height: 1.8;
            font-size: 14px;
            margin: 8px 0;
        }

        .info-box ul {
            margin: 10px 0 0 20px;
            color: #334155;
            line-height: 1.8;
        }

        .info-box li {
            margin: 8px 0;
            font-size: 14px;
        }

        .info-box strong {
            color: #1e40af;
            font-weight: 600;
        }

        .highlight-box {
            background: #fef3c7;
            padding: 20px 24px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #f59e0b;
        }

        .highlight-box h3 {
            color: #92400e;
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .highlight-box p, .highlight-box li {
            color: #78350f;
            line-height: 1.8;
            font-size: 14px;
        }

        .highlight-box ul {
            margin: 10px 0 0 20px;
        }

        .highlight-box li {
            margin: 8px 0;
        }

        .highlight-box strong {
            color: #92400e;
            font-weight: 600;
        }

        .warning-box {
            background: #fee2e2;
            padding: 20px 24px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #ef4444;
        }

        .warning-box h3 {
            color: #991b1b;
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .warning-box p, .warning-box li {
            color: #7f1d1d;
            line-height: 1.8;
            font-size: 14px;
        }

        .warning-box ul {
            margin: 10px 0 0 20px;
        }

        .warning-box li {
            margin: 8px 0;
        }

        .search-box {
            margin-bottom: 30px;
        }

        .search-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #1e293b;
            font-size: 15px;
        }

        .search-input {
            width: 100%;
            padding: 16px 20px;
            font-size: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            transition: all 0.3s;
            background: white;
        }

        .search-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .batch-search-container {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
            align-items: flex-start;
        }

        .batch-input-wrapper {
            flex: 1;
        }

        .batch-input {
            width: 100%;
            padding: 14px 18px;
            font-size: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            transition: all 0.3s;
        }

        .batch-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .add-button, .clear-button {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .add-button {
            background: #2563eb;
            color: white;
            box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
        }

        .add-button:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
        }

        .clear-button {
            background: #ef4444;
            color: white;
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
        }

        .clear-button:hover {
            background: #dc2626;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .stat-card {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            padding: 25px;
            border-radius: 12px;
            color: white;
            text-align: center;
            box-shadow: 0 4px 16px rgba(37, 99, 235, 0.25);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 24px rgba(37, 99, 235, 0.35);
        }

        .stat-card h3 {
            font-size: 14px;
            margin-bottom: 12px;
            opacity: 0.95;
            font-weight: 500;
        }

        .stat-card .number {
            font-size: 36px;
            font-weight: 700;
            margin: 5px 0;
        }

        .stat-card .sub {
            font-size: 13px;
            margin-top: 8px;
            opacity: 0.85;
        }

        .price-range-stats {
            margin-bottom: 35px;
        }

        .price-range-stats h2 {
            margin-bottom: 20px;
            color: #1e40af;
            font-size: 1.5em;
            font-weight: 700;
        }

        .range-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 18px;
        }

        .range-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            border-left: 5px solid #3b82f6;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            transition: all 0.3s;
            text-align: center;
        }

        .range-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            border-left-color: #2563eb;
        }

        .range-card .range-name {
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 10px;
            font-size: 15px;
        }

        .range-card .range-count {
            font-size: 28px;
            font-weight: 700;
            color: #2563eb;
            margin: 8px 0;
        }

        .range-card .range-percent {
            font-size: 14px;
            color: #64748b;
            margin-top: 6px;
        }

        .range-card .range-avg {
            font-size: 13px;
            color: #94a3b8;
            margin-top: 4px;
        }

        .issue-analysis {
            margin-bottom: 35px;
        }

        .issue-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
        }

        .issue-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            text-align: center;
            transition: all 0.3s;
        }

        .issue-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .issue-card.best {
            border: 2px solid #f59e0b;
            background: linear-gradient(to bottom, #fffbeb 0%, #ffffff 100%);
        }

        .issue-card .issue-num {
            font-size: 20px;
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 8px;
        }

        .issue-card .issue-count {
            font-size: 13px;
            color: #64748b;
            margin-bottom: 10px;
        }

        .issue-card .issue-stat {
            font-size: 13px;
            color: #334155;
            margin: 4px 0;
        }

        .issue-card .issue-highlight {
            background: #fbbf24;
            color: #78350f;
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            margin-top: 10px;
            display: inline-block;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            border: 1px solid #e2e8f0;
        }

        thead {
            background: #2563eb;
            color: white;
        }

        th {
            padding: 16px 15px;
            text-align: center;
            font-weight: 600;
            font-size: 14px;
        }

        tbody tr {
            border-bottom: 1px solid #f1f5f9;
            transition: background-color 0.2s;
        }

        tbody tr:hover {
            background: #f8fafc;
        }

        tbody tr:last-child {
            border-bottom: none;
        }

        td {
            padding: 14px 15px;
            font-size: 14px;
            color: #334155;
            text-align: center;
        }

        .no-result {
            text-align: center;
            padding: 50px;
            color: #94a3b8;
            font-size: 16px;
        }

        .total-row {
            background: #dbeafe !important;
            font-weight: 700;
            border-top: 2px solid #3b82f6 !important;
            color: #1e40af;
        }

        .total-row td {
            padding: 16px 15px;
        }

        .æŒ¯å¹…-high {
            color: #dc2626;
            font-weight: 700;
        }

        .æŒ¯å¹…-medium {
            color: #ea580c;
            font-weight: 600;
        }

        .æŒ¯å¹…-low {
            color: #16a34a;
            font-weight: 600;
        }

        .footer {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 30px;
            margin-top: 30px;
            text-align: center;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            border-top: 3px solid #3b82f6;
        }

        .footer-content {
            max-width: 900px;
            margin: 0 auto;
        }

        .footer h3 {
            color: #1e40af;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .footer p {
            color: #475569;
            font-size: 14px;
            line-height: 1.8;
            margin: 10px 0;
        }

        .footer .copyright {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
            color: #64748b;
            font-size: 13px;
        }

        .footer a {
            color: #2563eb;
            text-decoration: none;
            font-weight: 600;
        }

        .footer a:hover {
            text-decoration: underline;
            color: #1d4ed8;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5em;
            }

            .header-title {
                flex-direction: column;
                gap: 10px;
            }

            .tabs {
                flex-direction: column;
            }

            .tab-button {
                width: 100%;
            }

            .batch-search-container {
                flex-direction: column;
            }

            .add-button, .clear-button {
                width: 100%;
            }

            table {
                font-size: 13px;
            }

            th, td {
                padding: 10px 8px;
            }

            .issue-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-title">
                <span class="header-icon">ğŸ“Š</span>
                <h1>CBå¯è½‰å‚µç™¼è¡Œæ­·å²åƒ¹æ ¼æŸ¥è©¢ç³»çµ±</h1>
            </div>
            <div class="subtitle">æ›ç‰Œæœ€é«˜åƒ¹ | æ›ç‰Œæœ€ä½åƒ¹ | æŒ¯å¹…åˆ†æ | ç™¼è¡Œæ¬¡æ•¸ç¸¾æ•ˆç ”ç©¶</div>
            <div class="author">
                by 
                <a href="https://vocus.cc/user/@rexdashu168" target="_blank" style="color: #2563eb; text-decoration: none; font-weight: 600;">
                    Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤ï½œæ–¹æ ¼å­ vocus
                </a>
                <a href="https://www.youtube.com/@rexdashu168" target="_blank" style="margin-left: 10px; color: #dc2626; text-decoration: none; font-size: 1.1em;" title="YouTubeé »é“">
                    â–¶ï¸
                </a>
            </div>
            <div class="view-counter">
                ğŸ‘ï¸ ç´¯è¨ˆç€è¦½: <strong><span id="viewCount">0</span></strong> æ¬¡
            </div>
        </div>

        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('single')">ğŸ” å–®ä¸€æŸ¥è©¢</button>
            <button class="tab-button" onclick="switchTab('batch')">ğŸ“Š æ‰¹æ¬¡æŸ¥è©¢</button>
            <button class="tab-button" onclick="switchTab('all')">ğŸ“‹ å…¨éƒ¨è³‡æ–™</button>
            <button class="tab-button" onclick="switchTab('analysis')">ğŸ”¬ ç™¼è¡Œæ¬¡æ•¸åˆ†æ</button>
            <button class="tab-button" onclick="switchTab('advanced')">ğŸ“ˆ é€²éšåˆ†æ</button>
        </div>

        <!-- å–®ä¸€æŸ¥è©¢ -->
        <div id="single" class="tab-content active">
            <div class="info-box">
                <h3>ğŸ“Œ ä½¿ç”¨èªªæ˜</h3>
                <p><strong>æŸ¥è©¢æ–¹å¼ï¼š</strong>è¼¸å…¥CBä»£è™Ÿæˆ–å…¬å¸åç¨±é—œéµå­—å³å¯å³æ™‚æŸ¥è©¢</p>
                <p><strong>ä½¿ç”¨ç¯„ä¾‹ï¼š</strong>è¼¸å…¥ã€Œ6290ã€å¯æ‰¾åˆ°æ‰€æœ‰å‰å››ç¢¼ç‚º6290çš„æ¨™çš„(å¦‚62901ã€62902ç­‰),è¼¸å…¥ã€Œå°æ³¥ã€å¯æ‰¾åˆ°æ‰€æœ‰å«å°æ³¥çš„CB</p>
                <p><strong>åç¨±èªªæ˜ï¼š</strong>åç¨±æœ€å¾Œçš„ã€Œä¸€ã€äºŒã€ä¸‰...ã€ä»£è¡¨è©²å…¬å¸ç™¼è¡Œå¯è½‰å‚µçš„æ¬¡æ•¸</p>
            </div>

            <div class="highlight-box">
                <h3>ğŸ’¡ åŠŸèƒ½ç‰¹è‰²</h3>
                <ul>
                    <li><strong>æ¨¡ç³Šæœå°‹ï¼š</strong>è¼¸å…¥ä»£è™Ÿéƒ¨åˆ†æ•¸å­—(å¦‚6290)å³å¯æ‰¾å‡ºæ‰€æœ‰ç›¸é—œæ¨™çš„,æ–¹ä¾¿æ¯”è¼ƒåŒå…¬å¸ä¸åŒæ¬¡æ•¸ç™¼è¡Œ</li>
                    <li><strong>å³æ™‚çµ±è¨ˆï¼š</strong>è‡ªå‹•è¨ˆç®—å¹³å‡æœ€é«˜åƒ¹ã€æœ€ä½åƒ¹åŠæŒ¯å¹…,8æª”ä»¥ä¸Šé¡¯ç¤ºæ’é™¤å‰ä¸‰é«˜çµ±è¨ˆ</li>
                    <li><strong>è¦–è¦ºåŒ–å‘ˆç¾ï¼š</strong>æœ€é«˜åƒ¹å’ŒæŒ¯å¹…æ¡ç”¨æ·¡è‰²æ¼¸å±¤èƒŒæ™¯(ç´…â†’é»ƒâ†’ç¶ ),ä¸€çœ¼çœ‹å‡ºè¡¨ç¾å·®ç•°</li>
                    <li><strong>é¡è‰²èªªæ˜ï¼š</strong>ç´…è‰²=è¡¨ç¾è¼ƒå¥½ã€é»ƒè‰²=ä¸­ç­‰è¡¨ç¾ã€ç¶ è‰²=è¡¨ç¾è¼ƒå¼±</li>
                </ul>
            </div>

            <div class="search-box">
                <label class="search-label">è«‹è¼¸å…¥é—œéµå­—</label>
                <input 
                    type="text" 
                    class="search-input" 
                    id="singleSearchInput"
                    placeholder="ä¾‹å¦‚: 11011 æˆ– å°æ³¥"
                    onkeyup="searchSingle(event)"
                >
            </div>
            <div id="singleResult"></div>
        </div>

        <!-- æ‰¹æ¬¡æŸ¥è©¢ -->
        <div id="batch" class="tab-content">
            <div class="info-box">
                <h3>ğŸ“Œ æ‰¹æ¬¡æŸ¥è©¢èªªæ˜</h3>
                <p><strong>æŸ¥è©¢æ–¹å¼ï¼š</strong>è‡ªç”±åŠ å…¥å¤šæª”ä¸åŒæ¨™çš„é€²è¡Œæ¯”è¼ƒåˆ†æï¼ˆæœ€å¤š20æª”ï¼‰</p>
                <p><strong>é¡¯ç¤ºå…§å®¹ï¼š</strong>ç¶œåˆçµ±è¨ˆè¡¨ã€å¹³å‡æœ€é«˜åƒ¹ã€å¹³å‡æœ€ä½åƒ¹ã€æŒ¯å¹…åˆ†æ</p>
                <p><strong>é©åˆç”¨æ–¼ï¼š</strong>æ¯”è¼ƒä¸åŒå…¬å¸ã€è©•ä¼°æŠ•è³‡çµ„åˆã€åˆ¶å®šæŠ•è³‡ç­–ç•¥</p>
            </div>

            <div class="highlight-box">
                <h3>ğŸ’¡ ä½¿ç”¨æŠ€å·§</h3>
                <ul>
                    <li><strong>é€ç­†åŠ å…¥ï¼š</strong>è¼¸å…¥CBä»£ç¢¼å¾ŒæŒ‰Enteræˆ–é»æ“Šæ–°å¢æŒ‰éˆ•</li>
                    <li><strong>å³æ™‚çµ±è¨ˆï¼š</strong>è‡ªå‹•è¨ˆç®—å¹³å‡æœ€é«˜åƒ¹ã€æœ€ä½åƒ¹åŠæŒ¯å¹…</li>
                    <li><strong>éˆæ´»ç§»é™¤ï¼š</strong>å¯éš¨æ™‚ç§»é™¤ä¸éœ€è¦çš„é …ç›®é‡æ–°çµ±è¨ˆ</li>
                    <li><strong>åˆè¨ˆé¡¯ç¤ºï¼š</strong>è¡¨æ ¼æœ€ä¸‹æ–¹é¡¯ç¤ºæ‰€æœ‰é …ç›®çš„å¹³å‡æ•¸æ“š</li>
                </ul>
            </div>

            <div class="batch-search-container">
                <div class="batch-input-wrapper">
                    <input 
                        type="text" 
                        class="batch-input" 
                        id="batchInput"
                        placeholder="è¼¸å…¥CBä»£ç¢¼ (ä¾‹å¦‚: 11011)ï¼ŒæŒ‰Enteræˆ–é»æ“Šæ–°å¢"
                        onkeyup="addBatchItem(event)"
                    >
                </div>
                <button class="add-button" onclick="addBatchItem()">â• æ–°å¢</button>
                <button class="clear-button" onclick="clearBatch()">ğŸ—‘ï¸ æ¸…é™¤å…¨éƒ¨</button>
            </div>
            <div id="batchStats" style="margin-bottom: 20px;"></div>
            <div id="batchResult"></div>
        </div>

        <!-- å…¨éƒ¨è³‡æ–™ -->
        <div id="all" class="tab-content">
            <div class="info-box">
                <h3>ğŸ“Œ è³‡æ–™èªªæ˜</h3>
                <p><strong>è³‡æ–™æœŸé–“ï¼š</strong>93å¹´-114å¹´10æœˆ31æ—¥ï¼ˆæ¶µè“‹è¶…é20å¹´å®Œæ•´æ­·å²ï¼‰</p>
                <p><strong>è³‡æ–™å…§å®¹ï¼š</strong>åŒ…å«æ‰€æœ‰CBå¯è½‰å‚µçš„æ›ç‰Œæœ€é«˜åƒ¹ã€æœ€ä½åƒ¹åŠæŒ¯å¹…çµ±è¨ˆ</p>
                <p><strong>çµ±è¨ˆç¯„åœï¼š</strong>ç¸½è¨ˆ2,209æª”CBï¼Œæä¾›å®Œæ•´å¸‚å ´å…¨è²Œ</p>
            </div>

            <div class="highlight-box">
                <h3>ğŸ’¡ æ•¸æ“šäº®é»èˆ‡é¢¨éšªåˆ†æ</h3>
                <ul>
                    <li><strong>æŒ¯å¹…åˆ†å¸ƒï¼š</strong>è¶…é53%çš„CBæ›ç‰Œå¾ŒæŒ¯å¹…è¶…é50%,æ³¢å‹•ç›¸ç•¶é¡¯è‘—</li>
                    <li><strong>åƒ¹æ ¼è¡¨ç¾ï¼š</strong>ç´„46%çš„CBæœ€é«˜åƒ¹é”150å…ƒä»¥ä¸Š,é¡¯ç¤ºå¯è½‰å‚µå…·æœ‰ç›¸ç•¶çš„ä¸Šæ¼²æ½›åŠ›</li>
                    <li><strong>é¢¨éšªç‰¹æ€§ï¼š</strong>å¹³å‡æŒ¯å¹…é”82%,æŠ•è³‡äººéœ€ç‰¹åˆ¥æ³¨æ„åƒ¹æ ¼æ³¢å‹•é¢¨éšª</li>
                    <li><strong>ä¿æœ¬æ©Ÿåˆ¶åˆ†æï¼š</strong>å¹³å‡æœ€ä½åƒ¹ç´„92å…ƒ,æ¥è¿‘é¢é¡100å…ƒã€‚<span style="color: #c53030; font-weight: 600;">é€™ä»£è¡¨CBå…·æœ‰å‚µåˆ¸ä¿æœ¬ç‰¹æ€§,åªè¦å…¬å¸ä¸é•ç´„å€’é–‰,åˆ°æœŸæˆ–æå‰è³£å›å¯æ‹¿å›100å…ƒ</span></li>
                    <li><strong>è²·å…¥åƒ¹æ ¼é¢¨éšªï¼š</strong>è‹¥è²·åœ¨100å…ƒ,ä¸‹æª”é¢¨éšªç´„7-8%(è‡³92å…ƒ);è‹¥è²·åœ¨120å…ƒ,ä¸‹æª”é¢¨éšªæ“´å¤§è‡³23%(è‡³92å…ƒ)ã€‚<span style="color: #c53030; font-weight: 600;">è²·å…¥åƒ¹æ ¼è¶Šé«˜,å‚µåˆ¸ä¿æœ¬æ©Ÿåˆ¶ä¿è­·æ•ˆæœè¶Šå¼±</span></li>
                    <li><strong>é€¢ä½æ“ä½œç­–ç•¥ï¼š</strong>ç•¶CBå› æ„å¤–å› ç´ è·Œè‡³93å…ƒé™„è¿‘æ™‚,è‹¥åˆ¤æ–·å…¬å¸ä¸æœƒå€’é–‰,è·100å…ƒä»æœ‰7%åƒ¹å·®ç©ºé–“,æ­é…é©ç•¶çš„æå‰è³£å›æˆ–åˆ°æœŸæ“ä½œ,å¯ä½œç‚ºç›¸å°ç©©å¥çš„æŠ•è³‡ç­–ç•¥</li>
                </ul>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>ç¸½è¨ˆæª”æ•¸</h3>
                    <div class="number" id="totalCount">-</div>
                    <div class="sub">æ­·å²ç™¼è¡Œç¸½æ•¸</div>
                </div>
                <div class="stat-card">
                    <h3>æœ€é«˜åƒ¹å¹³å‡</h3>
                    <div class="number" id="avgHighest">-</div>
                    <div class="sub">æ›ç‰Œè¡¨ç¾</div>
                </div>
                <div class="stat-card">
                    <h3>æœ€ä½åƒ¹å¹³å‡</h3>
                    <div class="number" id="avgLowest">-</div>
                    <div class="sub">ä¿è­·åƒ¹æ ¼</div>
                </div>
            </div>

            <div class="price-range-stats">
                <h2>ğŸ“Š æ›ç‰Œæœ€é«˜åƒ¹å€é–“çµ±è¨ˆåˆ†æ</h2>
                <div class="range-grid" id="rangeStats"></div>
                
                <!-- é—œéµåƒ¹ä½åˆ†æ -->
                <div id="specialAnalysis"></div>
                
                <div class="info-box" style="margin-top: 25px;">
                    <h3>ğŸ’¡ é‡é»è§€å¯Ÿèˆ‡åˆ†æ</h3>
                    <ul>
                        <li><strong>110å…ƒä»¥ä¸‹å€é–“ï¼š</strong>é€™äº›CBæ›ç‰Œå¾Œè¡¨ç¾è¼ƒå¼±,å¯èƒ½å—åˆ°å¸‚å ´ç’°å¢ƒä¸ä½³ã€å…¬å¸åŸºæœ¬é¢ç–‘æ…®æˆ–è½‰æ›æ¢ä»¶ä¸å¸å¼•äººç­‰å› ç´ å½±éŸ¿</li>
                        <li><strong>110-150å…ƒå€é–“ï¼š</strong>ç´„ä½”æ•´é«”40%,å±¬æ–¼ä¸€èˆ¬è¡¨ç¾å€é–“,å¤§å¤šæ•¸CBè½åœ¨æ­¤ç¯„åœ,åæ˜ å¸‚å ´å¸¸æ…‹è¡¨ç¾</li>
                        <li><strong>150å…ƒä»¥ä¸Šå€é–“ï¼š</strong>ç´„ä½”æ•´é«”46%,é¡¯ç¤ºå¯è½‰å‚µå…·æœ‰ç›¸ç•¶çš„ä¸Šæ¼²æ½›åŠ›,ç‰¹åˆ¥æ˜¯200å…ƒä»¥ä¸Šçš„æ¨™çš„é€šå¸¸å…·æœ‰è‰¯å¥½çš„è½‰æ›åƒ¹å€¼æˆ–å¸‚å ´é¡Œæ</li>
                        <li><strong>æŠ•è³‡å•Ÿç¤ºï¼š</strong>æ›ç‰Œæœ€é«˜åƒ¹åˆ†å¸ƒå‘ˆç¾å…©æ¥µåŒ–,å»ºè­°æŠ•è³‡äººé—œæ³¨å…¬å¸åŸºæœ¬é¢ã€è½‰æ›æ¢ä»¶åŠå¸‚å ´ç’°å¢ƒ,é¿å…ç›²ç›®è¿½é«˜æˆ–éåº¦æ‚²è§€</li>
                    </ul>
                </div>
            </div>

            <div class="warning-box">
                <h3>âš ï¸ æŠ•è³‡é¢¨éšªæç¤º</h3>
                <p style="margin: 0;">æœ¬è³‡æ–™åƒ…ä¾›åƒè€ƒ,ä¸æ§‹æˆä»»ä½•æŠ•è³‡å»ºè­°ã€‚è©³ç´°é¢¨éšªèªªæ˜è«‹è¦‹é é¢æœ€ä¸‹æ–¹ã€‚</p>
            </div>

            <div id="allDataResult"></div>
        </div>

        <!-- ç™¼è¡Œæ¬¡æ•¸åˆ†æ -->
        <div id="analysis" class="tab-content">
            <div class="info-box">
                <h3>ğŸ“Œ åˆ†æèªªæ˜</h3>
                <p><strong>ç ”ç©¶ä¸»é¡Œï¼š</strong>å¯è½‰å‚µç™¼è¡Œæ¬¡æ•¸èˆ‡å¸‚å ´è¡¨ç¾çš„é—œè¯æ€§ç ”ç©¶</p>
                <p><strong>åˆ†ææ–¹æ³•ï¼š</strong>çµ±è¨ˆä¸åŒç™¼è¡Œæ¬¡æ•¸çš„CBåœ¨æ›ç‰Œå¾Œçš„åƒ¹æ ¼è¡¨ç¾</p>
                <p><strong>è³‡æ–™ç¯„åœï¼š</strong>å¾ç¬¬ä¸€æ¬¡åˆ°ç¬¬åæ¬¡ç™¼è¡Œï¼Œå…±2,047æª”æœ‰æ¨™ç¤ºç™¼è¡Œæ¬¡æ•¸çš„CB</p>
            </div>

            <div class="highlight-box">
                <h3>ğŸ¯ é‡å¤§ç™¼ç¾</h3>
                <ul>
                    <li><strong>ç¬¬ä¹æ¬¡ç™¼è¡Œè¡¨ç¾æœ€ä½³ï¼š</strong>å¹³å‡æœ€é«˜åƒ¹é”216.60å…ƒï¼Œé è¶…å…¶ä»–æ¬¡æ•¸</li>
                    <li><strong>ç¬¬ä¹æ¬¡æŒ¯å¹…æœ€å¤§ï¼š</strong>å¹³å‡æŒ¯å¹…122.6%ï¼Œä¸”100%çš„CBæŒ¯å¹…è¶…é50%</li>
                    <li><strong>ç¬¬ä¸€æ¬¡ç™¼è¡Œæ•¸é‡æœ€å¤šï¼š</strong>879æª”ä½”ç¸½æ•¸43%ï¼Œä½†è¡¨ç¾ä¸¦éæœ€ä½³</li>
                    <li><strong>å¤šæ¬¡ç™¼è¡Œå…¬å¸é«”è³ªï¼š</strong>èƒ½å¤šæ¬¡ç™¼è¡ŒCBçš„å…¬å¸é€šå¸¸è²¡å‹™ç©©å¥ã€å¸‚å ´èªå¯åº¦é«˜</li>
                </ul>
            </div>

            <div class="warning-box">
                <h3>âš ï¸ åˆ†æé™åˆ¶èªªæ˜</h3>
                <ul>
                    <li><strong>æ¨£æœ¬æ•¸å·®ç•°ï¼š</strong>ç¬¬ä¹æ¬¡ç™¼è¡Œåƒ…5æª”ï¼Œçµ±è¨ˆä»£è¡¨æ€§è¼ƒä½ï¼Œéœ€è¬¹æ…è§£è®€</li>
                    <li><strong>å­˜æ´»è€…åèª¤ï¼š</strong>èƒ½ç™¼è¡Œå¤šæ¬¡CBçš„å…¬å¸æœ¬èº«å¯èƒ½å°±æ˜¯å„ªè³ªä¼æ¥­ï¼Œé€ æˆçµ±è¨ˆåèª¤</li>
                    <li><strong>æ™‚é–“å› ç´ ï¼š</strong>ä¸åŒæ™‚æœŸç™¼è¡Œçš„CBå—å¸‚å ´ç’°å¢ƒå½±éŸ¿ï¼Œç„¡æ³•å–®ç´”æ¯”è¼ƒ</li>
                    <li><strong>ä¸å¯é æ¸¬æ€§ï¼š</strong>éå»æ•¸æ“šä¸èƒ½é æ¸¬æœªä¾†ï¼ŒæŠ•è³‡ä»éœ€å€‹æ¡ˆåˆ†æ</li>
                </ul>
            </div>

            <div class="issue-analysis">
                <h2 style="color: #1e40af; margin-bottom: 20px; font-weight: 700;">ğŸ“Š å„æ¬¡ç™¼è¡Œç¸¾æ•ˆæ¯”è¼ƒ</h2>
                <div class="issue-grid" id="issueGrid"></div>
            </div>

            <div class="info-box">
                <h3>ğŸ’­ æŠ•è³‡æ€è€ƒæ–¹å‘</h3>
                <ul>
                    <li><strong>è³ªé‡æ–¼é‡ï¼š</strong>ç™¼è¡Œæ¬¡æ•¸å¤šå¯¡ä¸æ˜¯å”¯ä¸€æŒ‡æ¨™ï¼Œå…¬å¸åŸºæœ¬é¢æ›´é‡è¦</li>
                    <li><strong>å¸‚å ´æ™‚æ©Ÿï¼š</strong>ç™¼è¡Œæ™‚çš„å¸‚å ´ç’°å¢ƒã€ç”¢æ¥­æ™¯æ°£éƒ½æœƒå½±éŸ¿è¡¨ç¾</li>
                    <li><strong>è½‰æ›æ¢ä»¶ï¼š</strong>è½‰æ›åƒ¹æ ¼ã€è½‰æ›æ¯”ç‡ç­‰æ¢ä»¶æ¯”ç™¼è¡Œæ¬¡æ•¸æ›´é—œéµ</li>
                    <li><strong>ç¶œåˆè©•ä¼°ï¼š</strong>æ‡‰çµåˆå…¬å¸è²¡å‹™ã€ç”¢æ¥­å‰æ™¯ã€å¸‚å ´ç‹€æ³ç­‰å¤šæ–¹é¢åˆ†æ</li>
                </ul>
            </div>
        </div>

        <!-- é€²éšåˆ†æ -->
        <div id="advanced" class="tab-content">
            <div class="info-box">
                <h3>ğŸ“Œ é€²éšåˆ†æèªªæ˜</h3>
                <p><strong>åˆ†æå…§å®¹ï¼š</strong>æä¾›ç”¢æ¥­åˆ†é¡ã€è©¢åœˆç«¶æ‹ã€æœ‰ç„¡æ“”ä¿ç­‰ä¸åŒç¶­åº¦çš„ç¸¾æ•ˆåˆ†æ</p>
                <p><strong>è³‡æ–™è™•ç†ï¼š</strong>æ‰€æœ‰åˆ†æå‡æ’é™¤è³‡æ–™ç‚º0æˆ–ç©ºå€¼çš„æ¨£æœ¬,ç¢ºä¿çµ±è¨ˆæº–ç¢ºæ€§</p>
                <p><strong>æ¨£æœ¬æ•¸æ¨™ç¤ºï¼š</strong>æ¯å€‹åˆ†æéƒ½æœƒé¡¯ç¤ºæœ‰æ•ˆæ¨£æœ¬æ•¸é‡,ä¾›æŠ•è³‡äººåƒè€ƒ</p>
            </div>

            <div class="highlight-box">
                <h3>ğŸ¯ åˆ†æç¶­åº¦</h3>
                <ul>
                    <li><strong>ç”¢æ¥­åˆ†é¡åˆ†æï¼š</strong>æ¯”è¼ƒä¸åŒç”¢æ¥­çš„CBè¡¨ç¾å·®ç•°</li>
                    <li><strong>è©¢åœˆvsç«¶æ‹ï¼š</strong>åˆ†æç™¼è¡Œæ–¹å¼å°æ›ç‰Œè¡¨ç¾çš„å½±éŸ¿</li>
                    <li><strong>æ“”ä¿æ¢ä»¶ï¼š</strong>æœ‰æ“”ä¿vsç„¡æ“”ä¿çš„è¡¨ç¾æ¯”è¼ƒ</li>
                </ul>
            </div>

            <!-- ç”¢æ¥­åˆ†é¡åˆ†æ -->
            <div style="margin: 30px 0;">
                <h2 style="color: #1e40af; margin-bottom: 20px; font-weight: 700;">ğŸ“Š ç”¢æ¥­åˆ†é¡ç¸¾æ•ˆåˆ†æ</h2>
                <div class="issue-grid" id="industryGrid"></div>
            </div>

            <!-- è©¢åœˆç«¶æ‹åˆ†æ -->
            <div style="margin: 30px 0;">
                <h2 style="color: #1e40af; margin-bottom: 20px; font-weight: 700;">ğŸ“Š è©¢åœˆvsç«¶æ‹ç¸¾æ•ˆåˆ†æ</h2>
                <div class="range-grid" id="inquiryGrid"></div>
                <div id="inquiryInsight" style="margin-top: 20px;"></div>
            </div>

            <!-- æ“”ä¿æ¢ä»¶åˆ†æ -->
            <div style="margin: 30px 0;">
                <h2 style="color: #1e40af; margin-bottom: 20px; font-weight: 700;">ğŸ“Š æœ‰ç„¡æ“”ä¿ç¸¾æ•ˆåˆ†æ</h2>
                <div class="range-grid" id="collateralGrid"></div>
                <div id="collateralInsight" style="margin-top: 20px;"></div>
            </div>

            <div class="warning-box">
                <h3>âš ï¸ åˆ†æé™åˆ¶èªªæ˜</h3>
                <ul>
                    <li><strong>è³‡æ–™å®Œæ•´æ€§ï¼š</strong>éƒ¨åˆ†æ¨™çš„è³‡æ–™ä¸å®Œæ•´,å·²æ’é™¤æ–¼åˆ†æä¹‹å¤–</li>
                    <li><strong>æ™‚é–“å› ç´ ï¼š</strong>ä¸åŒæ™‚æœŸç™¼è¡Œçš„CBå—å¸‚å ´ç’°å¢ƒå½±éŸ¿ä¸åŒ</li>
                    <li><strong>è¤‡åˆå› ç´ ï¼š</strong>CBè¡¨ç¾å—å¤šé‡å› ç´ å½±éŸ¿,å–®ä¸€ç¶­åº¦åˆ†æåƒ…ä¾›åƒè€ƒ</li>
                    <li><strong>å€‹æ¡ˆå·®ç•°ï¼š</strong>æŠ•è³‡ä»éœ€é‡å°å€‹åˆ¥æ¨™çš„é€²è¡Œå®Œæ•´è©•ä¼°</li>
                </ul>
            </div>
        </div>

        <div class="footer">
            <div class="footer-content">
                <h3>âš ï¸ æŠ•è³‡é¢¨éšªæç¤º</h3>
                <p>æœ¬è³‡æ–™åƒ…ä¾›åƒè€ƒ,ä¸æ§‹æˆä»»ä½•æŠ•è³‡å»ºè­°æˆ–å€‹è‚¡æ¨è–¦ã€‚å¯è½‰å‚µæŠ•è³‡æ¶‰åŠå¸‚å ´é¢¨éšª,æŠ•è³‡äººæ‡‰å¯©æ…è©•ä¼°è‡ªèº«é¢¨éšªæ‰¿å—èƒ½åŠ›ã€‚éå»ç¸¾æ•ˆä¸ä»£è¡¨æœªä¾†è¡¨ç¾,å¯¦éš›æŠ•è³‡çµæœå¯èƒ½æœ‰æ‰€ä¸åŒã€‚æŠ•è³‡å‰è«‹è©³é–±å…¬é–‹èªªæ˜æ›¸,äº†è§£å•†å“ç‰¹æ€§èˆ‡é¢¨éšªã€‚</p>
                
                <div class="copyright">
                    <p style="margin-top: 20px;"><strong>ğŸ“‹ è³‡æ–™ä¾†æºï¼š</strong>æœ¬ç³»çµ±è³‡æ–™æ•´ç†è‡ªå…¬é–‹è³‡è¨Š,å¯¦éš›æ•¸æ“šä»¥ä¸»ç®¡æ©Ÿé—œåŠç™¼è¡Œå…¬å¸æœ€æ–°å…¬å‘Šç‚ºæº–ã€‚è³‡æ–™æœŸé–“æ¶µè“‹93å¹´è‡³114å¹´10æœˆ31æ—¥ã€‚</p>
                    
                    <p style="margin-top: 15px;">
                        Â©ï¸ æœ¬ç³»çµ±ç”± 
                        <a href="https://vocus.cc/user/@rexdashu168" target="_blank">Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤ï½œæ–¹æ ¼å­ vocus</a> 
                        æ•´ç†è£½ä½œ,åƒ…ä¾›å€‹äººå­¸ç¿’èˆ‡ç ”ç©¶ä½¿ç”¨ã€‚
                    </p>
                    
                    <p style="margin-top: 10px;">
                        ğŸ“§ è¯çµ¡ä¿¡ç®±: <a href="mailto:rexdashu168@gmail.com">rexdashu168@gmail.com</a>
                        | 
                        â–¶ï¸ <a href="https://www.youtube.com/@rexdashu168" target="_blank">YouTubeé »é“</a>
                    </p>
                    
                    <p style="margin-top: 10px; color: #94a3b8;">å¦‚æœ‰ä»»ä½•å•é¡Œæˆ–å»ºè­°,æ­¡è¿äº¤æµè¨è«–ã€‚</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let cbData = [];
        let batchItems = [];
        let issueAnalysis = null;

        // è¼‰å…¥è³‡æ–™
        async function loadData() {
            try {
                const response = await fetch('cb_data.json');
                cbData = await response.json();
                console.log(`å·²è¼‰å…¥ ${cbData.length} ç­†è³‡æ–™`);
                updateAllDataStats();
                loadIssueAnalysis();
                loadAdvancedAnalysis();
            } catch (error) {
                console.error('è¼‰å…¥è³‡æ–™å¤±æ•—:', error);
            }
        }

        // è¼‰å…¥é€²éšåˆ†æ
        function loadAdvancedAnalysis() {
            analyzeByIndustry();
            analyzeByInquiry();
            analyzeByCollateral();
        }

        // ç”¢æ¥­åˆ†é¡åˆ†æ
        function analyzeByIndustry() {
            const industryStats = {};
            
            cbData.forEach(item => {
                const industry = item.industry;
                if (!industry || industry === 0 || industry === '') return;
                
                if (!industryStats[industry]) {
                    industryStats[industry] = {
                        count: 0,
                        totalHighest: 0,
                        totalLowest: 0
                    };
                }
                
                industryStats[industry].count++;
                industryStats[industry].totalHighest += item.highest || 0;
                industryStats[industry].totalLowest += item.lowest || 0;
            });

            // è¨ˆç®—å¹³å‡ä¸¦æ’åº
            const results = Object.entries(industryStats)
                .map(([industry, stats]) => ({
                    name: industry,
                    count: stats.count,
                    avgHighest: stats.totalHighest / stats.count,
                    avgLowest: stats.totalLowest / stats.count,
                    avgAmplitude: ((stats.totalHighest / stats.count - stats.totalLowest / stats.count) / (stats.totalLowest / stats.count)) * 100
                }))
                .filter(item => item.count >= 10) // åªé¡¯ç¤º10æª”ä»¥ä¸Šçš„ç”¢æ¥­
                .sort((a, b) => b.avgHighest - a.avgHighest);

            // é¡¯ç¤ºå‰15å
            const top15 = results.slice(0, 15);
            const best = top15[0];
            
            let html = '';
            top15.forEach(item => {
                const isBest = item.name === best.name;
                html += `
                    <div class="issue-card ${isBest ? 'best' : ''}">
                        <div class="issue-num">${item.name}</div>
                        <div class="issue-count">${item.count} æª”</div>
                        <div class="issue-stat">æœ€é«˜ ${item.avgHighest.toFixed(1)}</div>
                        <div class="issue-stat">æœ€ä½ ${item.avgLowest.toFixed(1)}</div>
                        <div class="issue-stat">æŒ¯å¹… ${item.avgAmplitude.toFixed(1)}%</div>
                        ${isBest ? '<div class="issue-highlight">â˜… è¡¨ç¾æœ€ä½³</div>' : ''}
                    </div>
                `;
            });
            
            document.getElementById('industryGrid').innerHTML = html;
        }

        // è©¢åœˆç«¶æ‹åˆ†æ
        function analyzeByInquiry() {
            const inquiryStats = {};
            
            cbData.forEach(item => {
                const inquiry = item.inquiry_type;
                if (!inquiry || inquiry === 0 || inquiry === '') return;
                
                if (!inquiryStats[inquiry]) {
                    inquiryStats[inquiry] = {
                        count: 0,
                        totalHighest: 0,
                        totalLowest: 0
                    };
                }
                
                inquiryStats[inquiry].count++;
                inquiryStats[inquiry].totalHighest += item.highest || 0;
                inquiryStats[inquiry].totalLowest += item.lowest || 0;
            });

            let html = '';
            let insightHtml = '<div class="info-box"><h3>ğŸ’¡ åˆ†æè§€å¯Ÿ</h3><ul>';
            
            Object.entries(inquiryStats).forEach(([type, stats]) => {
                const avgHighest = (stats.totalHighest / stats.count).toFixed(2);
                const avgLowest = (stats.totalLowest / stats.count).toFixed(2);
                const avgAmplitude = (((stats.totalHighest / stats.count - stats.totalLowest / stats.count) / (stats.totalLowest / stats.count)) * 100).toFixed(1);
                const percent = ((stats.count / cbData.length) * 100).toFixed(1);
                
                html += `
                    <div class="range-card">
                        <div class="range-name">${type}</div>
                        <div class="range-count">${stats.count} æª”</div>
                        <div class="range-percent">å æ¯” ${percent}%</div>
                        <div class="range-avg">æœ€é«˜ ${avgHighest} | æœ€ä½ ${avgLowest}</div>
                        <div class="range-avg">æŒ¯å¹… ${avgAmplitude}%</div>
                    </div>
                `;
                
                insightHtml += `<li><strong>${type}(${stats.count}æª”):</strong> å¹³å‡æœ€é«˜åƒ¹${avgHighest}å…ƒï¼ŒæŒ¯å¹…${avgAmplitude}%</li>`;
            });
            
            insightHtml += '</ul></div>';
            
            document.getElementById('inquiryGrid').innerHTML = html;
            document.getElementById('inquiryInsight').innerHTML = insightHtml;
        }

        // æ“”ä¿æ¢ä»¶åˆ†æ
        function analyzeByCollateral() {
            const collateralStats = {};
            
            cbData.forEach(item => {
                const collateral = item.collateral;
                if (!collateral || collateral === 0 || collateral === '') return;
                
                if (!collateralStats[collateral]) {
                    collateralStats[collateral] = {
                        count: 0,
                        totalHighest: 0,
                        totalLowest: 0
                    };
                }
                
                collateralStats[collateral].count++;
                collateralStats[collateral].totalHighest += item.highest || 0;
                collateralStats[collateral].totalLowest += item.lowest || 0;
            });

            let html = '';
            let insightHtml = '<div class="info-box"><h3>ğŸ’¡ åˆ†æè§€å¯Ÿ</h3><ul>';
            
            Object.entries(collateralStats).forEach(([type, stats]) => {
                const avgHighest = (stats.totalHighest / stats.count).toFixed(2);
                const avgLowest = (stats.totalLowest / stats.count).toFixed(2);
                const avgAmplitude = (((stats.totalHighest / stats.count - stats.totalLowest / stats.count) / (stats.totalLowest / stats.count)) * 100).toFixed(1);
                const percent = ((stats.count / cbData.length) * 100).toFixed(1);
                
                html += `
                    <div class="range-card">
                        <div class="range-name">${type}</div>
                        <div class="range-count">${stats.count} æª”</div>
                        <div class="range-percent">å æ¯” ${percent}%</div>
                        <div class="range-avg">æœ€é«˜ ${avgHighest} | æœ€ä½ ${avgLowest}</div>
                        <div class="range-avg">æŒ¯å¹… ${avgAmplitude}%</div>
                    </div>
                `;
                
                insightHtml += `<li><strong>${type}(${stats.count}æª”):</strong> å¹³å‡æœ€é«˜åƒ¹${avgHighest}å…ƒï¼ŒæŒ¯å¹…${avgAmplitude}%</li>`;
            });
            
            insightHtml += '</ul></div>';
            
            document.getElementById('collateralGrid').innerHTML = html;
            document.getElementById('collateralInsight').innerHTML = insightHtml;
        }

        // è¼‰å…¥è³‡æ–™

        // è¼‰å…¥ç™¼è¡Œæ¬¡æ•¸åˆ†æ
        function generateStatsInfo(data) {
            if (data.length === 0) return '';

            const totalHighest = data.reduce((sum, item) => sum + (item.highest || 0), 0);
            const totalLowest = data.reduce((sum, item) => sum + (item.lowest || 0), 0);
            const avgHighest = (totalHighest / data.length).toFixed(2);
            const avgLowest = (totalLowest / data.length).toFixed(2);
            const avgAmplitude = ((avgHighest - avgLowest) / avgLowest * 100).toFixed(1);

            let statsHTML = `
                <div class="info-box" style="background: #dbeafe; border-color: #3b82f6; margin-bottom: 20px;">
                    <strong style="color: #1e40af; font-size: 16px;">
                        ğŸ“Š æŸ¥è©¢çµæœçµ±è¨ˆ (${data.length}æª”)
                        | æœ€é«˜åƒ¹å¹³å‡: ${avgHighest} å…ƒ
                        | æœ€ä½åƒ¹å¹³å‡: ${avgLowest} å…ƒ
                        | å¹³å‡æŒ¯å¹…: ${avgAmplitude}%
                    </strong>
            `;

            // 8æª”ä»¥ä¸Šé¡¯ç¤ºæ’é™¤å‰ä¸‰é«˜çµ±è¨ˆ
            if (data.length >= 8) {
                const sortedItems = [...data].sort((a, b) => b.highest - a.highest);
                const excludedItems = sortedItems.slice(3);
                
                const excludedTotalHighest = excludedItems.reduce((sum, item) => sum + item.highest, 0);
                const excludedTotalLowest = excludedItems.reduce((sum, item) => sum + item.lowest, 0);
                const excludedAvgHighest = (excludedTotalHighest / excludedItems.length).toFixed(2);
                const excludedAvgLowest = (excludedTotalLowest / excludedItems.length).toFixed(2);
                const excludedAvgAmplitude = ((excludedAvgHighest - excludedAvgLowest) / excludedAvgLowest * 100).toFixed(1);

                statsHTML += `
                    <br><br>
                    <strong style="color: #ea580c; font-size: 16px;">
                        ğŸ¯ æ’é™¤å‰ä¸‰é«˜çµ±è¨ˆ (${excludedItems.length}æª”)
                        | æœ€é«˜åƒ¹å¹³å‡: ${excludedAvgHighest} å…ƒ
                        | æœ€ä½åƒ¹å¹³å‡: ${excludedAvgLowest} å…ƒ
                        | å¹³å‡æŒ¯å¹…: ${excludedAvgAmplitude}%
                    </strong>
                    <p style="color: #64748b; font-size: 13px; margin-top: 8px;">
                        ğŸ’¡ æ’é™¤æ¥µç«¯å€¼å¾Œæ›´èƒ½åæ˜ æ•´é«”è¡¨ç¾
                    </p>
                `;
            }

            statsHTML += `</div>`;
            return statsHTML;
        }

        // è¨ˆç®—æ¼¸å±¤é¡è‰²
        function getGradientColor(value, min, max, reverse = false) {
            const ratio = (value - min) / (max - min);
            const adjustedRatio = reverse ? 1 - ratio : ratio;
            
            let r, g, b;
            if (adjustedRatio < 0.5) {
                // ç¶ è‰²åˆ°é»ƒè‰²
                r = Math.round(144 + (255 - 144) * (adjustedRatio * 2));
                g = Math.round(238 - (238 - 193) * (adjustedRatio * 2));
                b = Math.round(144 - 144 * (adjustedRatio * 2));
            } else {
                // é»ƒè‰²åˆ°ç´…è‰²
                r = 255;
                g = Math.round(193 - 193 * ((adjustedRatio - 0.5) * 2));
                b = 0;
            }
            
            return `rgb(${r}, ${g}, ${b}, 0.15)`;
        }

        function loadIssueAnalysis() {
            const issueStats = {};
            const chineseNums = ['ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'ä¸ƒ', 'å…«', 'ä¹', 'å'];
            
            cbData.forEach(item => {
                const lastChar = item.name[item.name.length - 1];
                if (chineseNums.includes(lastChar)) {
                    if (!issueStats[lastChar]) {
                        issueStats[lastChar] = {
                            count: 0,
                            totalHighest: 0,
                            totalLowest: 0,
                            items: []
                        };
                    }
                    issueStats[lastChar].count++;
                    issueStats[lastChar].totalHighest += item.highest;
                    issueStats[lastChar].totalLowest += item.lowest;
                    issueStats[lastChar].items.push(item);
                }
            });

            const results = [];
            chineseNums.forEach(num => {
                if (issueStats[num]) {
                    const stat = issueStats[num];
                    const avgHighest = stat.totalHighest / stat.count;
                    const avgLowest = stat.totalLowest / stat.count;
                    const avgAmplitude = ((avgHighest - avgLowest) / avgLowest) * 100;
                    
                    results.push({
                        num: num,
                        count: stat.count,
                        avgHighest: avgHighest,
                        avgLowest: avgLowest,
                        avgAmplitude: avgAmplitude
                    });
                }
            });

            issueAnalysis = results;
            updateIssueGrid();
        }

        function updateIssueGrid() {
            if (!issueAnalysis || issueAnalysis.length === 0) return;

            const gridDiv = document.getElementById('issueGrid');
            const best = issueAnalysis.reduce((max, item) => 
                item.avgHighest > max.avgHighest ? item : max
            );

            let html = '';
            issueAnalysis.forEach(item => {
                const isBest = item.num === best.num;
                html += `
                    <div class="issue-card ${isBest ? 'best' : ''}">
                        <div class="issue-num">ç¬¬${item.num}æ¬¡</div>
                        <div class="issue-count">${item.count} æª”</div>
                        <div class="issue-stat">æœ€é«˜ ${item.avgHighest.toFixed(1)}</div>
                        <div class="issue-stat">æœ€ä½ ${item.avgLowest.toFixed(1)}</div>
                        <div class="issue-stat">æŒ¯å¹… ${item.avgAmplitude.toFixed(1)}%</div>
                        ${isBest ? '<div class="issue-highlight">â˜… è¡¨ç¾æœ€ä½³</div>' : ''}
                    </div>
                `;
            });

            gridDiv.innerHTML = html;
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'all' && cbData.length > 0) {
                showAllData();
            } else if (tabName === 'analysis' && issueAnalysis) {
                updateIssueGrid();
            } else if (tabName === 'advanced' && cbData.length > 0) {
                loadAdvancedAnalysis();
            }
        }

        function searchSingle(event) {
            const keyword = document.getElementById('singleSearchInput').value.trim();
            const resultDiv = document.getElementById('singleResult');

            if (!keyword) {
                resultDiv.innerHTML = '';
                return;
            }

            // æ¨¡ç³Šæœå°‹:ä»£è™ŸåŒ…å«é—œéµå­— æˆ– åç¨±åŒ…å«é—œéµå­—
            const results = cbData.filter(item => 
                item.code.includes(keyword) || item.name.includes(keyword)
            );

            if (results.length === 0) {
                resultDiv.innerHTML = '<div class="no-result">æŸ¥ç„¡è³‡æ–™</div>';
                return;
            }

            // åŠ å…¥çµ±è¨ˆè³‡è¨Š
            const statsInfo = generateStatsInfo(results);
            resultDiv.innerHTML = statsInfo + createTable(results);
        }

        function addBatchItem(event) {
            if (event && event.key !== 'Enter') return;

            const input = document.getElementById('batchInput');
            const code = input.value.trim();

            if (!code) return;

            const item = cbData.find(d => d.code === code);
            
            if (!item) {
                alert('æŸ¥ç„¡æ­¤ä»£ç¢¼');
                return;
            }

            if (batchItems.some(b => b.code === code)) {
                alert('æ­¤ä»£ç¢¼å·²åŠ å…¥');
                return;
            }

            if (batchItems.length >= 20) {
                alert('æœ€å¤šåªèƒ½åŠ å…¥20æª”');
                return;
            }

            batchItems.push(item);
            input.value = '';
            updateBatchDisplay();
        }

        function clearBatch() {
            if (batchItems.length === 0) return;
            if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰é …ç›®å—?')) {
                batchItems = [];
                updateBatchDisplay();
            }
        }

        function updateBatchDisplay() {
            const statsDiv = document.getElementById('batchStats');
            const resultDiv = document.getElementById('batchResult');

            if (batchItems.length === 0) {
                statsDiv.innerHTML = '';
                resultDiv.innerHTML = '<div class="no-result">å°šæœªæ–°å¢ä»»ä½•é …ç›®<br>è«‹åœ¨ä¸Šæ–¹è¼¸å…¥æ¡†è¼¸å…¥CBä»£ç¢¼å¾ŒæŒ‰Enteræˆ–é»æ“Šæ–°å¢æŒ‰éˆ•</div>';
                return;
            }

            const totalHighest = batchItems.reduce((sum, item) => sum + (item.highest || 0), 0);
            const totalLowest = batchItems.reduce((sum, item) => sum + (item.lowest || 0), 0);
            const avgHighest = (totalHighest / batchItems.length).toFixed(2);
            const avgLowest = (totalLowest / batchItems.length).toFixed(2);
            const avgAmplitude = ((avgHighest - avgLowest) / avgLowest * 100).toFixed(1);

            let statsHTML = `
                <div class="info-box" style="background: #dbeafe; border-color: #3b82f6;">
                    <strong style="color: #1e40af; font-size: 16px;">
                        ğŸ“Š å·²é¸æ“‡ ${batchItems.length} æª” 
                        | æœ€é«˜åƒ¹å¹³å‡: ${avgHighest} å…ƒ
                        | æœ€ä½åƒ¹å¹³å‡: ${avgLowest} å…ƒ
                        | å¹³å‡æŒ¯å¹…: ${avgAmplitude}%
                    </strong>
            `;

            // 8æª”ä»¥ä¸Šé¡¯ç¤ºæ’é™¤å‰ä¸‰é«˜çµ±è¨ˆ
            if (batchItems.length >= 8) {
                const sortedItems = [...batchItems].sort((a, b) => b.highest - a.highest);
                const excludedItems = sortedItems.slice(3); // æ’é™¤å‰3é«˜
                
                const excludedTotalHighest = excludedItems.reduce((sum, item) => sum + item.highest, 0);
                const excludedTotalLowest = excludedItems.reduce((sum, item) => sum + item.lowest, 0);
                const excludedAvgHighest = (excludedTotalHighest / excludedItems.length).toFixed(2);
                const excludedAvgLowest = (excludedTotalLowest / excludedItems.length).toFixed(2);
                const excludedAvgAmplitude = ((excludedAvgHighest - excludedAvgLowest) / excludedAvgLowest * 100).toFixed(1);

                statsHTML += `
                    <br><br>
                    <strong style="color: #ea580c; font-size: 16px;">
                        ğŸ¯ æ’é™¤å‰ä¸‰é«˜çµ±è¨ˆ (${excludedItems.length}æª”)
                        | æœ€é«˜åƒ¹å¹³å‡: ${excludedAvgHighest} å…ƒ
                        | æœ€ä½åƒ¹å¹³å‡: ${excludedAvgLowest} å…ƒ
                        | å¹³å‡æŒ¯å¹…: ${excludedAvgAmplitude}%
                    </strong>
                    <p style="color: #64748b; font-size: 13px; margin-top: 8px;">
                        ğŸ’¡ æ’é™¤æ¥µç«¯å€¼å¾Œæ›´èƒ½åæ˜ æ•´é«”è¡¨ç¾
                    </p>
                `;
            } else if (batchItems.length > 0 && batchItems.length < 8) {
                statsHTML += `
                    <p style="color: #64748b; font-size: 13px; margin-top: 8px;">
                        ğŸ’¡ åŠ å…¥è‡³å°‘8æª”æ¨™çš„å³å¯çœ‹åˆ°ã€Œæ’é™¤å‰ä¸‰é«˜ã€çµ±è¨ˆåˆ†æ
                    </p>
                `;
            }

            statsHTML += `</div>`;
            statsDiv.innerHTML = statsHTML;

            resultDiv.innerHTML = createTable(batchItems, true);
        }

        function removeBatchItem(code) {
            batchItems = batchItems.filter(item => item.code !== code);
            updateBatchDisplay();
        }

        function createTable(data, showRemove = false) {
            if (data.length === 0) return '';

            const totalHighest = data.reduce((sum, item) => sum + (item.highest || 0), 0);
            const totalLowest = data.reduce((sum, item) => sum + (item.lowest || 0), 0);
            const avgHighest = (totalHighest / data.length).toFixed(2);
            const avgLowest = (totalLowest / data.length).toFixed(2);

            // è¨ˆç®—æŒ¯å¹…å’Œæœ€é«˜åƒ¹çš„ç¯„åœ(ç”¨æ–¼æ¼¸å±¤è‰²)
            const amplitudes = data.map(item => ((item.highest - item.lowest) / item.lowest * 100));
            const highests = data.map(item => item.highest);
            const minAmp = Math.min(...amplitudes);
            const maxAmp = Math.max(...amplitudes);
            const minHigh = Math.min(...highests);
            const maxHigh = Math.max(...highests);

            let html = `
                <table>
                    <thead>
                        <tr>
                            <th>ä»£è™Ÿ</th>
                            <th>åç¨±</th>
                            <th>æ›ç‰Œæœ€é«˜åƒ¹</th>
                            <th>æ›ç‰Œæœ€ä½åƒ¹</th>
                            <th>æŒ¯å¹…</th>
                            ${showRemove ? '<th>æ“ä½œ</th>' : ''}
                        </tr>
                    </thead>
                    <tbody>
            `;

            data.forEach(item => {
                const amplitude = ((item.highest - item.lowest) / item.lowest * 100).toFixed(1);
                const amplitudeClass = amplitude > 50 ? 'vibration-high' : amplitude > 20 ? 'vibration-medium' : 'vibration-low';
                
                // è¨ˆç®—æ¼¸å±¤èƒŒæ™¯è‰²
                const ampBgColor = data.length > 1 ? getGradientColor(parseFloat(amplitude), minAmp, maxAmp, false) : 'transparent';
                const highBgColor = data.length > 1 ? getGradientColor(item.highest, minHigh, maxHigh, false) : 'transparent';
                
                html += `
                    <tr>
                        <td>${item.code}</td>
                        <td>${item.name}</td>
                        <td style="background: ${highBgColor}; font-weight: 600;">${item.highest}</td>
                        <td>${item.lowest}</td>
                        <td style="background: ${ampBgColor};" class="${amplitudeClass}">${amplitude}%</td>
                        ${showRemove ? `<td><button onclick="removeBatchItem('${item.code}')" style="padding: 6px 12px; background: #ef4444; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: 600;">ç§»é™¤</button></td>` : ''}
                    </tr>
                `;
            });

            if (data.length > 1) {
                const totalAmplitude = ((avgHighest - avgLowest) / avgLowest * 100).toFixed(1);
                html += `
                    <tr class="total-row">
                        <td colspan="2">ğŸ“Š åˆè¨ˆ/å¹³å‡ (${data.length}æª”)</td>
                        <td>${avgHighest}</td>
                        <td>${avgLowest}</td>
                        <td>${totalAmplitude}%</td>
                        ${showRemove ? '<td></td>' : ''}
                    </tr>
                `;
            }

            html += `
                    </tbody>
                </table>
            `;

            return html;
        }

        function updateAllDataStats() {
            const totalCount = cbData.length;
            const totalHighest = cbData.reduce((sum, item) => sum + (item.highest || 0), 0);
            const totalLowest = cbData.reduce((sum, item) => sum + (item.lowest || 0), 0);
            const avgHighest = (totalHighest / totalCount).toFixed(2);
            const avgLowest = (totalLowest / totalCount).toFixed(2);

            document.getElementById('totalCount').textContent = totalCount;
            document.getElementById('avgHighest').textContent = avgHighest;
            document.getElementById('avgLowest').textContent = avgLowest;

            const ranges = {
                '110ä»¥ä¸‹': { min: 0, max: 110, count: 0, total: 0 },
                '110-130': { min: 110, max: 130, count: 0, total: 0 },
                '130-150': { min: 130, max: 150, count: 0, total: 0 },
                '150-175': { min: 150, max: 175, count: 0, total: 0 },
                '175-200': { min: 175, max: 200, count: 0, total: 0 },
                '200ä»¥ä¸Š': { min: 200, max: Infinity, count: 0, total: 0 }
            };

            // ç‰¹æ®Šæ¢ä»¶çµ±è¨ˆ
            let above130 = 0;  // å¤§æ–¼ç­‰æ–¼130(å…¬å¸æœ‰æ¬Šè´–å›)
            let below130 = 0;  // ä½æ–¼130
            let above160 = 0;  // å¤§æ–¼ç­‰æ–¼160
            let below160 = 0;  // ä½æ–¼160

            cbData.forEach(item => {
                const price = item.highest;
                
                // å€é–“çµ±è¨ˆ
                for (let range in ranges) {
                    if (price >= ranges[range].min && price < ranges[range].max) {
                        ranges[range].count++;
                        ranges[range].total += price;
                        break;
                    }
                }
                
                // 130åˆ†ç•Œçµ±è¨ˆ
                if (price >= 130) above130++;
                else below130++;
                
                // 160åˆ†ç•Œçµ±è¨ˆ
                if (price >= 160) above160++;
                else below160++;
            });

            let rangeHtml = '';
            for (let range in ranges) {
                const data = ranges[range];
                const percent = ((data.count / totalCount) * 100).toFixed(1);
                const avg = data.count > 0 ? (data.total / data.count).toFixed(2) : 0;
                
                rangeHtml += `
                    <div class="range-card">
                        <div class="range-name">${range}</div>
                        <div class="range-count">${data.count} æª”</div>
                        <div class="range-percent">å æ¯” ${percent}%</div>
                        <div class="range-avg">å¹³å‡ ${avg} å…ƒ</div>
                    </div>
                `;
            }

            document.getElementById('rangeStats').innerHTML = rangeHtml;
            
            // é¡¯ç¤ºç‰¹æ®Šæ¢ä»¶åˆ†æ
            const above130Percent = ((above130 / totalCount) * 100).toFixed(1);
            const below130Percent = ((below130 / totalCount) * 100).toFixed(1);
            const above160Percent = ((above160 / totalCount) * 100).toFixed(1);
            const below160Percent = ((below160 / totalCount) * 100).toFixed(1);
            
            document.getElementById('specialAnalysis').innerHTML = `
                <div class="info-box" style="background: #fef3c7; border-color: #f59e0b; margin-top: 25px;">
                    <h3>ğŸ¯ é—œéµåƒ¹ä½åˆ†æ</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 15px;">
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                            <h4 style="color: #92400e; margin-bottom: 10px; font-size: 15px;">ğŸ“Œ 130å…ƒåˆ†ç•Œåˆ†æ(å…¬å¸è´–å›æ¬Š)</h4>
                            <p style="color: #78350f; font-size: 14px; line-height: 1.8; margin: 5px 0;">
                                <strong style="color: #dc2626;">â‰¥ 130å…ƒ:</strong> ${above130}æª” (${above130Percent}%)<br>
                                <strong style="color: #059669;">< 130å…ƒ:</strong> ${below130}æª” (${below130Percent}%)
                            </p>
                            <p style="color: #78350f; font-size: 13px; margin-top: 10px; padding-top: 10px; border-top: 1px solid #fde68a;">
                                ğŸ’¡ <strong>åˆ†ææ„ç¾©:</strong>ç•¶CBåƒ¹æ ¼é”130å…ƒä»¥ä¸Š,å…¬å¸æœ‰æ¬Šæå‰è´–å›ã€‚<span style="color: #dc2626; font-weight: 600;">è¶…é${above130Percent}%çš„CBæ›¾é”æ­¤é–€æª»</span>,é¡¯ç¤ºå¤šæ•¸CBå…·æœ‰è§¸ç™¼è´–å›æ¢ä»¶çš„æ½›åŠ›,æŠ•è³‡äººéœ€æ³¨æ„è´–å›é¢¨éšªèˆ‡æ™‚æ©Ÿã€‚
                            </p>
                        </div>
                        
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                            <h4 style="color: #1e40af; margin-bottom: 10px; font-size: 15px;">ğŸ“Œ 160å…ƒåˆ†ç•Œåˆ†æ(é«˜ç²åˆ©æ©Ÿæœƒ)</h4>
                            <p style="color: #1e293b; font-size: 14px; line-height: 1.8; margin: 5px 0;">
                                <strong style="color: #dc2626;">â‰¥ 160å…ƒ:</strong> ${above160}æª” (${above160Percent}%)<br>
                                <strong style="color: #059669;">< 160å…ƒ:</strong> ${below160}æª” (${below160Percent}%)
                            </p>
                            <p style="color: #1e293b; font-size: 13px; margin-top: 10px; padding-top: 10px; border-top: 1px solid #dbeafe;">
                                ğŸ’¡ <strong>åˆ†ææ„ç¾©:</strong>160å…ƒä»£è¡¨60%çš„ç²åˆ©ç©ºé–“(è‹¥ä»¥100å…ƒè²·å…¥)ã€‚<span style="color: #dc2626; font-weight: 600;">${above160Percent}%çš„CBæ›¾é”æ­¤æ°´æº–</span>,é¡¯ç¤ºå¯è½‰å‚µå…·æœ‰ç›¸ç•¶çš„ç²åˆ©æ½›åŠ›,ä½†ä¹Ÿä¼´éš¨è¼ƒé«˜çš„æ³¢å‹•é¢¨éšªã€‚
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        function showAllData() {
            const resultDiv = document.getElementById('allDataResult');
            resultDiv.innerHTML = createTable(cbData);
        }

        // ç€è¦½è¨ˆæ•¸åŠŸèƒ½
        function updateViewCount() {
            const storageKey = 'cb_system_view_count';
            let count = localStorage.getItem(storageKey);
            
            if (!count) {
                count = 0;
            }
            
            count = parseInt(count) + 1;
            localStorage.setItem(storageKey, count);
            
            document.getElementById('viewCount').textContent = count.toLocaleString();
        }

        window.onload = function() {
            loadData();
            updateViewCount();
        };
    </script>
</body>
</html>
